<!doctype html>
<html lang="en">

    <head>
        <meta charset="utf-8">

        <title>Webentwicklung mit node.js - JavaScript WTF</title>

        <meta name="author" content="peerigon">

        <meta name="apple-mobile-web-app-capable" content="yes" />
        <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />

        <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

        <link rel="stylesheet" href="../../assets/reveal.js/css/reveal.min.css">
        <link rel="stylesheet" href="../../assets/reveal.js/css/theme/sky.css" id="theme">

        <!-- For syntax highlighting -->
        <link rel="stylesheet" href="../../assets/reveal.js/lib/css/zenburn.css">

        <!-- If the query includes 'print-pdf', use the PDF print sheet -->
        <script>
            document.write( '<link rel="stylesheet" href="../../assets/reveal.js/css/print/' + ( window.location.search.match( /print-pdf/gi ) ? 'pdf' : 'paper' ) + '.css" type="text/css" media="print">' );
        </script>
        
        <style type="text/css">
            .reveal section .no-border {
                background: transparent;
                border: 0;
                box-shadow: 0 0 0;
            }

            .reveal h2 {
                line-height: 1.2em;
            }

            h1, h2, h3, h4, h5, h6 {
                text-rendering: optimizeLegibility;
            }
        </style>

        <!--[if lt IE 9]>
        <script src="../../assets/reveal.js/lib/js/html5shiv.js"></script>
        <![endif]-->
    </head>

    <body>

        <div class="reveal">

            <small style="padding: 10px;">
                Webentwicklung mit node.js<br/>HS Augsburg
            </small>

            <small style="padding: 10px; float: right; text-align: right;">
                Test-Driven Development<br/>11.06.2013
            </small>

            <!-- Any section element inside of this container is displayed as a slide -->
            <div class="slides">

                <section>
                    <h2>Einführug in Test-Driven Development (TDD)</h2>
                    <p>(mit Mocha und Chai.js)</p>
                    <br>
                    <br>
                    <p>
                        <small>Paul Torka <a href="https://peerigon.com">peerigon UG</a></small>
                    </p>
                </section>

                <section>
                    <h2>Agenda</h2>

                    <ul>
                        <li>Über mich</li>
                        <li>Was ist TDD?</li>
                        <li>Unit-Tests</li>
                        <li>Weitere Begrifflichkeiten</li>
                        <li>Mocha und Chai.js</li>
                        <li>Demo</li>
                        <li>Was gibt es sonst noch zu sagen?</li>
                    </ul>
                </section>

                <section>
                    <section>
                        <h2>Über mich</h2>
                    </section>
                    <section>
                        <img class="no-border" src="img/roomieplanet.png" style="width: 200px;"/>
                        <img class="no-border" src="img/mc_logo.jpg" style="width: 200px;"/>
                        <img class="no-border" src="img/peerigon.png" style="width: 100px">

                        <ul>
                            <li>roomieplanet</li>
                            <li>Wirtschaftsinformatik (B. Sc.) an der HSA</li>
                            <li>Software-Entwickler bei meteocontrol</li>
                            <li>peerigon</li>
                        </ul>
                    </section>
                    <section>
                        <ul>
                            <li>Cross-Platform- & Cross-Device-Apps</li>
                            <li>Single Page Applications</li>
                            <li>Automatisierung: TDD, Continuous Integration & Delivery (CI/CD)</li>
                        </ul>
                    </section>
                </section>

                <section>
                    <section>
                        <h2>Was ist TDD?</h2>
                        <aside class="notes">
                            <p>Zitate welche die Aspekte von TDD beleuchten</p>
                        </aside>
                    </section>
                    <section>
                        <blockquote>
                            Test-Driven Development (TDD) is a software development methodology
                            that helps to create an environment of comfort and confidence [...]
                        </blockquote>
                        <br>
                        <small>Jeffrey Winesett (Agile Web Application Development with Yii 1.1 and PHP5 | S.??)</small>
                    </section>
                    <section>
                        <blockquote>
                            Test-driven development (TDD) is an advanced technique of using automated unit tests
                            to drive the design of software and force decoupling of dependencies.
                        </blockquote>
                        <br>
                        <small>Jeffrey Palermo <a href="http://msdn.microsoft.com/en-us/library/aa730844(v=vs.80).aspx">(Guidelines for Test-Driven Development)</a></small>
                    </section>
                    <section>
                        <h3>TDD</h3>

                        <ul>
                            <li>ist eine Technik/Methode der Software-Entwicklung</li>
                            <li>automatisierte Unit Tests</li>
                            <li>beeinflusst das Design der Software</li>
                            <li>schafft Komfort und (Selbst-)Vertrauen</li>
                        </ul>
                    </section>
                </section>

                <section>
                    <section>
                        <h2>Methode</h2>

                        <ul>
                            <li>Test First Programming</li>
                            <li>Red - Green - Refactor</li>
                        </ul>
                    </section>
                    <section>
                        <h3>The TDD mantra</h3>

                        <ol>
                            <li><em>Red</em>: Write a little test that doesn't work [...] .</li>
                            <li><em>Green</em>: Make the test work quickly, committing whatever sins necessary in the process.</li>
                            <li><em>Refactor</em>: Eliminate all of the duplication created in merely getting the test to work</li>
                        </ol>
                        <br>
                        <br>
                        <small>Kent Beck (Test-Driven Development By Example|Preface|S. 10)</small>

                        <!--<ol>-->
                            <!--<li>You may not write production code until you have written a failing [...] test.</li>-->
                            <!--<li>You may not write more of a unit test than is sufficient to fail [...].</li>-->
                            <!--<li>You may not write more production code than is sufficient to pass the currently failig test</li>-->
                        <!--</ol>-->
                        <!--<br/>-->
                        <!--<small>Robert C. Martin (Clean Code|Chapter 9: Unit Tests|S.122)</small>-->
                    </section>

                    <section>
                        <h3>Software Design</h3>
                        <p>Die Qualität der Software wird gesteigert durch</p>
                        <ul>
                            <li>besser durchdachte APIs</li>
                            <li>einfachem, lesbarem, wartbarem und</li>
                            <li>wiederverwendbarem Code</li>
                        </ul>
                    </section>
                    <section>
                        <h3>Bessere APIs</h3>
                        <p><em>Red</em>: Ein Test ist bereits der erste Anwendungsfall.</p>
                    </section>
                    <section>
                        <h3>Einfacher Code</h3>
                        <p><em>Green</em>: Ein Test soll mit möglichst wenig Aufwand erfolgreich durchlaufen.</p>
                    </section>
                    <section>
                        <h3>Wiederverwandbarer Code</h3>
                        <p><em>Refactor</em>: Beim Refactoren sollen Redundanzen eliminiert und das Design optimiert werden.</p>
                    </section>

                    <section>
                        <h3>Komfort & Vertrauen</h3>
                    </section>
                    <section>
                        <h4>Never touch a running system!!!</h4>
                        <br>
                        <ul>
                            <li class="fragment">Änderung können unerwartete Seiteneffekte haben</li>
                            <li class="fragment">manuelles testen ist zeitintensiv</li>
                            <li class="fragment">Debuggen ist mühselig</li>
                        </ul>
                    </section>
                    <section>
                        <h3>Realität</h3>
                        <p>Software ist nicht starr, sondern organisch. Denn ...</p>
                        <br/>
                        <ul>
                            <li class="fragment">Spezifikationen/Anforderungen ändern sich</li>
                            <li class="fragment">die Umgebung (Server, Node) ändert sich</li>
                            <li class="fragment">eingesetzte Libs (Bug-Fixes, API-Änderungen) werden geupdated</li>
                            <li class="fragment">man lernt nie aus: Erfahrung und Skills</li>
                        </ul>
                    </section>
                    <section>
                        <h3>Komfort & Vertrauen durch TDD</h3>
                        <ul>
                            <li class="fragment">Wo und was läuft schief?</li>
                            <li class="fragment">Minimierung von unerwarteten Seiteneffekten.</li>
                        </ul>
                    </section>
                </section>

                <section>
                    <section>
                        <h2>Was ist ein Unit-Test?</h2>
                        <p class="fragment">
                            Ein Unit-Test ist ein Test, der einen möglichst kleinen Teil der Anwendung, z.B. eine Funktion einer Klasse,
                            auf Richtigkeit der Funktionalität überprüft.
                        </p>
                    </section>
                    <section>
                        <h3>Eigenschaften eines guten Unit Tests (F.I.R.S.T)</h3>
                        <ul>
                            <li class="fragment"><em>Fast</em>: Tests should run fast. [...] (Komfort!)</li>
                            <li class="fragment"><em>Independent</em>: Tests should not depend on each other. [...]</li>
                            <li class="fragment"><em>Repeatable</em>: Tests should be repeatable in any environment. [...] (Vertrauen!)</li>
                            <li class="fragment"><em>Self-Validation</em>: The tests should have a [...] output. Either they pass or fail. (Komfort!)</li>
                            <li class="fragment">
                                <em>Timely</em>: [...] Unit tests should be written just before the production code that makes them pass.
                            </li>
                        </ul>
                        <br/>
                        <br/>
                        <small class="fragment">Robert C. Martin (Clean Code|Chapter 9: Unit Tests|S. 132/133)</small>

                        <aside class="notes">
                            <ul>
                                <li>
                                    <em>Fast</em>: They should run fast. They should run quickly. When tests run slow, you won't
                                    want to run them frequently. If you don't run them frequently, you won't find problems
                                    early enough to fix them easily. You won't fell as free to clean up the code.
                                    Eventually the code will begin to rod.
                                </li>
                                <li>
                                    <em>Independent</em>: Tests should not depend on each other. One test should not set up
                                    the conditions for the next test. You should be able to run each test independently and
                                    run the tests in any order you like. When tests depend on each other, then the first one to
                                    fail causes a cascade of downstream failures, making diagnosis difficult and hiding downstream
                                    defects.
                                </li>
                                <li>
                                    <em>Repeatable</em>: Tests should be repeatable in any environment. You should be able to
                                    run the tests in the production environment, in the QA environment, and on your laptop
                                    while riding home on the train without a network. If your tests aren't repeatable in any
                                    environment, then you'll always have an excuse for why they fail. You'll also find
                                </li>
                                <li>
                                    <em>Self-Validation</em>: The tests should have a boolean output. Either they pass or fail.
                                    You should not have to read through a log file to tell whether the tests pass. You should
                                    not have to manually compare two different text files to see whether the tests pass. If the
                                    tests aren't self-validating, then failure can become subjective and running the tests
                                    can require a long manual evaluation
                                </li>
                                <li>
                                    <em>Timely</em>: The tests need to be written in a timely fashion. Unit test should be written
                                    just before the production code that makes them pass. If you write tests after the production
                                    code, then you may find the production code to be hard to test. You may decide that some
                                    production code is too hard to test. You may not design the production code to be testable
                                </li>
                            </ul>
                        </aside>
                    </section>
                </section>

                <section>
                    <section>
                        <h2>Weitere Begrifflichkeiten</h2>
                    </section>
                    <section>
                        <h3>Test-Suite</h3>
                        <p>Die Gesamtheit aller Unit-Tests einer Anwendung.</p>
                    </section>
                    <section>
                        <h3>Test-Runner/Testing Framework</h3>
                        <p>Ein Framework, das die Test-Suite per "Knopfdruck" ausführt.</p>
                    </section>
                    <section>
                        <h3>Assertion-Suite</h3>
                        <p>Ein Framework, das bei der Überprüfung des erwarteten Outputs bzw. der Rückgabeparameter hilft.</p>
                        <br>
                        <ul>
                            <li>Meist fester Bestandteil eines Testing Framework.</li>
                            <li>node.js bietet bereits selbst das Module <em><a href=http://nodejs.org/api/assert.html>assert</a></em> an.</li>
                        </ul>
                        <br>
                        <pre><code>var assert = require("assert");</code></pre>
                    </section>
                </section>

                <section>
                    <section>
                        <h2>Mocha</h2>
                        <blockquote>
                            Mocha is a feature-rich JavaScript test framework running on node and the browser,
                            making asynchronous testing simple and fun.
                            Mocha tests run serially, allowing for flexible and accurate reporting,
                            while mapping uncaught exceptions to the correct test cases.
                            Hosted on <a href="https://github.com/visionmedia/mocha">GitHub</a>.
                        </blockquote>
                    </section>
                    <section>
                        <h3>Installation</h3>
                        <pre><code>npm install -g mocha</code></pre>
                    </section>
                    <section>
                        <h3>Wo sollen die Tests hin?</h3>
                        <p>Im Modul auf root-Ebene in einen Ordner, der "test" heißt.</p>
<pre><code>
    |_ examples
    |_ lib
    |_ test

       |_ MeinTest.js
       |_ NochEinTest.js

    |_ package.json

</code></pre>
                    </section>
                    <section>
                        <h3>Mocha - Beispiel 1</h3>
<pre><code>

// Test-Suite definieren
describe("MeineKlasse", function () {

    before(function () {
        // Einmaliges initiales Setup für die Test-Suite
    });
    beforeEach(function () {
        // Setup für jeden Test
    });
    afterEach(function () {
        // Aufräumen nach jedem Test
    });
    after(function () {
        // Einmaliges aufräumen nach
    });

    // Unit-Tests für "meineFunktion" gruppieren
    describe(".meineFunktion()", function () {
        // Beschreibung/Spezifikation des Unit-Tests
        it("should work", function () {
            // Unit-Test 1
        });
        it("should also work", function () {
            // Unit-Test 2
        });
    });

});

</code></pre>
                    </section>
                    <section>
                        <h3>Mocha - Beispiel 2</h3>
<pre><code>
var assert = require("assert");

describe('Array', function () {
    describe('.indexOf()', function () {
        it('should return -1 when the value is not present',
            function () {
                assert.equal(-1, [1, 2, 3].indexOf(5));
                assert.equal(-1, [1, 2, 3].indexOf(0));
            }
        );
    });
});
</code></pre>
                        <br>
                        <small>TJ Holowaychuck (<a href="http://visionmedia.github.io/mocha/#assertions">http://visionmedia.github.io/mocha/</a>)</small>
                    </section>
                </section>
                <section>
                    <section>
                        <h2>Chai</h2>
                        <blockquote>
                            Chai is a BDD / TDD assertion library for node and the browser that can be delightfully
                            paired with any javascript testing framework.
                        </blockquote>
                        <small><a href="http://chaijs.com/">Chai Assertion Libray</a></small>
                    </section>
                    <section>
                        <h3>Installation</h3>
                        <p>npm:</p>
                        <pre><code>npm install chai</code></pre>
                        <p>package.json</p>
<pre><code>
    {
        // ...
        "devDependencies": {
            // ...
            "chai": "latest"
        }
        // ...
    }
</code></pre>
                    </section>
                    <section>
                        <h3>Chai - Beispiel 1</h3>
<pre><code>
var expect = require("chai").expect;

describe("Array (Chai)", function () {
    describe('.indexOf()', function () {
        it('should return -1 when the value is not present',
            function () {
                expect([1, 2, 3].indexOf(4)).to.equal(-1);
                expect([1, 2, 3].indexOf(0)).to.equal(-1);
            }
        );
    });
});
</code></pre>
                    </section>
                    <section>
                        <h3>Chai - Beispiel 2</h3>

<pre><code>
// ...

describe('.eql()', function () {
    it("should be eql", function () {
        expect([1, 3, 5]).to.be.eql([2, 4, 6]);
    });
});
</code></pre>
<pre><code>
    ․․․

    ✖ 1 of 3 tests failed:

    1) Array (Chai) .eql() should be eql:

    actual expected

    1 | [
    2 |   21,
    3 |   43,
    4 |   65
    5 | ]

</code></pre>
                    </section>
                    <section>
                        <h2>Demo</h2>
                        <h3>Red - Green- Refactor</h3>
                    </section>

                </section>
                <section>
                    <section>
                        <h2>Was gibt es sonst noch zu sagen?</h2>
                    </section>
                    <section>
                        <p>Nicht getestet werden sollten ...</p>
                        <ul>
                            <li class="fragment">Sprachkonstrukte</li>
                            <li class="fragment">native Funktionen</li>
                            <li class="fragment">Module, die über NPM installiert wurden</li>
                        </ul>
                    </section>
                    <section>
                        <h3>Integrations Test</h3>
                        <ul>
                            <li>Unit-Tests sind nur eine Art von Test.</li>
                            <li>Unit-Tests alleine sind nicht ausreichend, um eine Anwendung komplett zu testen.</li>
                            <li>Es sind weitere Tests nötig, die das Zusammenspiel der Komponenten testen (z.B. Datenbank)</li>
                        </ul>
                    </section>
                    <section>
                        <h3>private & protected</h3>
                        <ul>
                            <li>Müssen/sollen nicht getestet werden.</li>
                            <li>Können getestet werden, wenn man sich damit wohler fühlt (Vertrauen & Komfort).</li>
                        </ul>
                    </section>
                    <section>
                        <h3>Weitere Automatisierung</h3>
                        <ul>
                            <li>Continuous Integration</li>
                            <li>Continuous Delivery</li>
                        </ul>
                    </section>
                    <section>
                        <h3>Weitere Testing Frameworks/Test-Runner für Node (und Browser)</h3>
                        <ul>
                            <li><a href="http://pivotal.github.io/jasmine/">Jasmine</a></li>
                            <li><a href="http://qunitjs.com/">QUnit</a></li>
                        </ul>
                    </section>
                    <section>
                        <h3>Do it!</h3>
                    </section>
                </section>
                <section>
                    <section>
                        <h2>Fragen?</h2>
                    </section>
                </section>

            </div>

        </div>

        <script src="../../assets/reveal.js/lib/js/head.min.js"></script>
        <script src="../../assets/reveal.js/js/reveal.min.js"></script>

        <script>

            // Full list of configuration options available here:
            // https://github.com/hakimel/reveal.js#configuration
            Reveal.initialize({
                controls: true,
                progress: true,
                history: true,
                center: true,

                theme: Reveal.getQueryHash().theme, // available themes are in /css/theme
                transition: Reveal.getQueryHash().transition || 'default', // default/cube/page/concave/zoom/linear/fade/none

                // Optional libraries used to extend on reveal.js
                dependencies: [
                    { src: '../../assets/reveal.js/lib/js/classList.js', condition: function() { return !document.body.classList; } },
                    { src: '../../assets/reveal.js/plugin/markdown/showdown.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
                    { src: '../../assets/reveal.js/plugin/markdown/markdown.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
                    { src: '../../assets/reveal.js/plugin/highlight/highlight.js', async: true, callback: function() { hljs.initHighlightingOnLoad(); } },
                    { src: '../../assets/reveal.js/plugin/zoom-js/zoom.js', async: true, condition: function() { return !!document.body.classList; } },
                    { src: '../../assets/reveal.js/plugin/notes/notes.js', async: true, condition: function() { return !!document.body.classList; } }
                    // { src: '../../assets/reveal.js/plugin/search/search.js', async: true, condition: function() { return !!document.body.classList; } }
                    // { src: '../../assets/reveal.js/plugin/remotes/remotes.js', async: true, condition: function() { return !!document.body.classList; } }
                ]
            });

        </script>

    </body>
</html>
